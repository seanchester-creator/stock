<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Stock Inventory</title>
  <style>
    :root{
      --bg:#000;
      --text:#fff;
      --panel:#121212;
      --muted:#1b1b1b;
      --border:#2a2a2a;
      --accent:#ff0;
      --accent2:#fff;
    }
    body[data-theme="blackwhite"]{
      --bg:#000;--text:#fff;--panel:#121212;--muted:#1b1b1b;--border:#2a2a2a;--accent:#fff;--accent2:#000;
    }
    body[data-theme="blackyellow"]{
      --bg:#000;--text:#fff;--panel:#121212;--muted:#1b1b1b;--border:#2a2a2a;--accent:#ffd500;--accent2:#fff;
    }
    body[data-theme="whiteblack"]{
      --bg:#fff;--text:#000;--panel:#f2f2f2;--muted:#eaeaea;--border:#ccc;--accent:#000;--accent2:#fff;
    }
    body[data-theme="rasta"]{
      --bg:#000;--text:#fff;--panel:#111;--muted:#222;--border:#333;--accent:#e11;--accent2:#ff0;
    }
    body[data-theme="neon"]{
      --bg:#000;--text:#fff;--panel:#111;--muted:#191919;--border:#333;--accent:#0ff;--accent2:#f0f;
    }
    *{box-sizing:border-box}
    body{margin:0;font:18px system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:var(--text)}
    header{display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;background:var(--panel);padding:12px;border-bottom:1px solid var(--border);z-index:10}
    h1{margin:0;font-size:20px}
    select.theme{padding:6px;border-radius:8px;background:var(--muted);color:var(--text);border:1px solid var(--border)}
    .wrap{max-width:900px;margin:auto;padding:16px}
    .card{background:var(--panel);border:1px solid var(--border);border-radius:12px;padding:16px;margin-bottom:16px}
    label{display:block;margin:8px 0 4px;font-size:14px;color:var(--text)}
    input,select,button{font:inherit;font-size:16px}
    input,select{width:100%;padding:10px;border-radius:8px;border:1px solid var(--border);background:var(--muted);color:var(--text)}
    button{padding:12px 16px;border-radius:10px;border:0;margin-top:8px;width:100%}
    .btn.primary{background:var(--accent);color:var(--accent2);font-weight:700}
    .btn.danger{background:#e11;color:#fff}
    .list{display:grid;gap:10px}
    .item{background:var(--muted);padding:12px;border-radius:10px}
    .sizes{display:flex;flex-wrap:wrap;gap:6px;margin-top:6px}
    .size{padding:4px 8px;border-radius:8px;background:var(--panel);border:1px solid var(--border)}
    #editorSection{display:none;margin-top:20px}
    .reorder{display:flex;gap:8px;margin:8px 0}
    .chips{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
    .chip{display:flex;align-items:center;gap:8px;padding:8px 10px;border-radius:12px;background:var(--panel);border:1px solid var(--border)}
    .chip button{padding:6px 10px;font-size:18px;font-weight:700;border-radius:8px;border:0}
    .chip button.plus{background:var(--accent);color:var(--accent2)}
    .chip button.minus{background:var(--accent2);color:var(--accent)}
    #adminBadge{display:none;background:var(--accent);color:var(--accent2);font-weight:700;padding:6px 12px;border-radius:8px;margin:8px 0;display:inline-block}
  </style>
</head>
<body data-theme="blackwhite">
<header>
  <h1>üëï Stock Inventory</h1>
  <select id="themeSelect" class="theme">
    <option value="blackwhite">Black & White</option>
    <option value="blackyellow">Black & Yellow</option>
    <option value="whiteblack">White & Black</option>
    <option value="rasta">Rasta</option>
    <option value="neon">Neon</option>
  </select>
</header>
<main class="wrap">
  <section class="card">
    <div class="list" id="list"></div>
    <div id="empty">No items yet.</div>
  </section>
  <section class="card" id="passwordSection">
    <h2>Admin Access</h2>
    <label>Password</label>
    <input type="password" id="passwordInput" placeholder="Enter password">
    <button class="btn primary" id="unlockBtn">Unlock</button>
  </section>
  <div id="adminBadge">üîì Admin Mode Active</div>
  <section class="card" id="editorSection">
    <h2>Add / Edit Item</h2>
    <label>Select Item</label><select id="itemSelect"><option value="">-- New Item --</option></select>
    <div class="reorder"><button id="moveUpBtn">‚¨ÜÔ∏è</button><button id="moveDownBtn">‚¨áÔ∏è</button></div>
    <label>Brand</label><input id="brandInput">
    <label>Colour</label><input id="colorInput">
    <label>Style</label>
    <select id="styleSelect">
      <option>softstyle</option><option>cotton</option>
      <option>heavy cotton</option><option>ultra heavy</option>
      <option>mid softstyle</option><option value="other">Other</option>
    </select>
    <input id="customStyleInput" placeholder="Custom style" style="display:none;margin-top:6px">
    <label>Sizes & Stock</label><div class="chips" id="sizesChips"></div>
    <div id="measurementsSection" style="display:none"><h3>Measurements</h3><div id="measurementInputs"></div></div>
    <button class="btn primary" id="saveItemBtn">Save</button>
    <button id="resetBtn" class="btn" style="background:#888;color:#fff">Reset</button>
    <button class="btn danger" id="deleteBtn">Delete</button>
  </section>
</main>
<template id="itemTmpl"><div class="item"><div><span class="color"></span> ‚Äì <strong class="brand"></strong> <span class="note"></span></div><div class="sizes"></div></div></template>
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js"></script>
<script>
const firebaseConfig={
  apiKey:"AIzaSyCklSHKdm_sB83BsrDKuMzXddGgFi26w5w",
  authDomain:"stock-2d5a3.firebaseapp.com",
  projectId:"stock-2d5a3",
  storageBucket:"stock-2d5a3.firebasestorage.app",
  messagingSenderId:"419253323633",
  appId:"1:419253323633:web:d6e4adca4d2464f320d8d0"
};
firebase.initializeApp(firebaseConfig);
const db=firebase.firestore();
const sizesDefault=["S","M","L","XL","2XL","3XL","4XL"];
const el=id=>document.getElementById(id);
let currentId=null,sizeMap={},measurements={},cachedItems=[];

document.getElementById("themeSelect").onchange=()=>{
  document.body.setAttribute("data-theme",document.getElementById("themeSelect").value);
  localStorage.setItem("tsi_theme",document.getElementById("themeSelect").value);
};
if(localStorage.getItem("tsi_theme")){document.body.setAttribute("data-theme",localStorage.getItem("tsi_theme"));document.getElementById("themeSelect").value=localStorage.getItem("tsi_theme");}

el("unlockBtn").onclick=()=>{
  if(el("passwordInput").value==="sonny"){
    el("editorSection").style.display="block";
    el("passwordSection").style.display="none";
    el("adminBadge").style.display="inline-block";
    resetEditor();render();
  } else alert("Wrong password");
};
el("styleSelect").onchange=()=>{el("customStyleInput").style.display=el("styleSelect").value==="other"?"block":"none"};
function initSizeChips(initial={}){el("sizesChips").innerHTML="";sizeMap={};sizesDefault.forEach(s=>{sizeMap[s]=initial[s]||0;const d=document.createElement("div");d.className="chip";d.innerHTML=`<strong>${s}</strong><button class='minus' data-delta=-1>‚àí</button><span class=qty>${sizeMap[s]}</span><button class='plus' data-delta=1>+</button>`;d.onclick=e=>{if(e.target.dataset.delta){sizeMap[s]=Math.max(0,sizeMap[s]+ +e.target.dataset.delta);d.querySelector(".qty").textContent=sizeMap[s];}};el("sizesChips").appendChild(d)});updateMeasurementsInputs(initial.measurements)};
function updateMeasurementsInputs(initial={}){el("measurementInputs").innerHTML="";sizesDefault.forEach(s=>{const i=document.createElement("input");i.placeholder=s+" measurement";i.value=initial[s]||"";i.oninput=()=>{measurements[s]=i.value};el("measurementInputs").appendChild(i)});el("measurementsSection").style.display="block"};
async function loadItems(){const snap=await db.collection("inventory").get();const items=snap.docs.map(doc=>({...doc.data(),id:doc.id}));items.sort((a,b)=>(a.order??0)-(b.order??0));cachedItems=items;return items;}
async function saveItem(item){if(!item.order) item.order=Date.now();if(item.id){await db.collection("inventory").doc(item.id).set(item);}else{const ref=await db.collection("inventory").add(item);item.id=ref.id;}}
async function deleteItem(id){await db.collection("inventory").doc(id).delete();}
async function render(){const items=await loadItems();el("list").innerHTML="";if(!items.length){el("empty").style.display="block";}else el("empty").style.display="none";el("itemSelect").innerHTML="<option value=''>-- New Item --</option>";items.forEach(it=>{el("itemSelect").innerHTML+=`<option value='${it.id}'>${it.color} ‚Äì ${it.brand} (${it.style})</option>`;el("list").appendChild(renderItem(it))})}
function renderItem(it){let n=el("itemTmpl").content.firstElementChild.cloneNode(true);n.dataset.id=it.id;n.querySelector(".brand").textContent=it.brand;n.querySelector(".color").textContent=it.color;n.querySelector(".note").textContent=it.style?`(${it.style})`:'';let s=n.querySelector(".sizes");Object.entries(it.sizes||{}).forEach(([k,v])=>{let d=document.createElement("div");d.className="size";d.textContent=`${k}: ${v}`;s.appendChild(d)});if(it.measurements){let m=document.createElement("div");m.style.marginTop="6px";m.textContent="Measurements: "+Object.entries(it.measurements).map(([k,v])=>`${k}: ${v}`).join(", ");n.appendChild(m)}return n}
async function editItem(id){const doc=await db.collection("inventory").doc(id).get();if(!doc.exists)return;const it=doc.data();it.id=doc.id;currentId=it.id;el("brandInput").value=it.brand||"";el("colorInput").value=it.color||"";el("styleSelect").value=["softstyle","cotton","heavy cotton","ultra heavy","mid softstyle"].includes(it.style)?it.style:"other";if(el("styleSelect").value==="other"){el("customStyleInput").style.display="block";el("customStyleInput").value=it.style}else el("customStyleInput").style.display="none";measurements={...it.measurements};initSizeChips(it.sizes);updateMeasurementsInputs(it.measurements);el("itemSelect").value=it.id}
el("itemSelect").onchange=()=>{el("itemSelect").value?editItem(el("itemSelect").value):resetEditor()};
el("saveItemBtn").onclick=async()=>{let b=el("brandInput").value.trim(),c=el("colorInput").value.trim();if(!b||!c)return alert("Need brand & colour");let st=el("styleSelect").value;if(st==="other") st=el("customStyleInput").value.trim()||"Other";let obj={id:currentId,brand:b,color:c,style:st,sizes:{...sizeMap},measurements:{...measurements}};const existing=cachedItems.find(x=>x.id===currentId);if(existing&&existing.order)obj.order=existing.order;await saveItem(obj);resetEditor();render()};
el("resetBtn").onclick=resetEditor;
el("deleteBtn").onclick=async()=>{if(currentId&&confirm("Delete?")){await deleteItem(currentId);resetEditor();render()}};
async function move(delta){if(!currentId)return;const items=[...cachedItems];const i=items.findIndex(x=>x.id===currentId);const j=i+delta;if(i<0||j<0||j>=items.length)return;const a=items[i],b=items[j];const ao=a.order??(i+1)*1000,bo=b.order??(j+1)*1000;await db.collection('inventory').doc(a.id).set({order:bo},{merge:true});await db.collection('inventory').doc(b.id).set({order:ao},{merge:true});await render();el("itemSelect").value=currentId}
el("moveUpBtn").onclick=()=>move(-1);el("moveDownBtn").onclick=()=>move(1);
function resetEditor(){currentId=null;el("brandInput").value=el("colorInput").value=el("customStyleInput").value="";el("styleSelect").value="softstyle";el("customStyleInput").style.display="none";measurements={};initSizeChips();el("itemSelect").value=""}
render();
</script>
</body>
</html>